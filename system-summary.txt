# 動画視聴トラッキングSaaS - 機能まとめと導入手順

## 1. 主要機能

### 管理者向け機能
- **コース管理**
  - コースの作成・編集・削除
  - 複数の動画をコースとしてまとめることが可能
  - 動画の並び順指定

- **動画管理**
  - 複数の埋め込み方法に対応
    - YouTube、Vimeo等の外部プラットフォーム動画
    - MP4などの直接URL
    - カスタム埋め込みコード
  - 動画情報（タイトル、説明、長さ）の管理

- **統計・分析**
  - コース別の視聴統計
  - ユーザー別の視聴時間の追跡
  - 完了率の計算と表示
  - ユーザーの学習進捗状況の把握

### 視聴者向け機能
- **コース閲覧**
  - 利用可能なコース一覧の閲覧
  - コースへの登録
  - 視聴進捗状況の確認

- **動画視聴**
  - 視聴時間の自動トラッキング
  - 視聴の一時停止・再開
  - 視聴進捗のリアルタイム更新
  - 複数デバイスでの視聴履歴同期

## 2. 技術構成

### フロントエンド
- **言語/フレームワーク**: JavaScript, React
- **ルーティング**: React Router
- **HTTP通信**: Axios
- **スタイリング**: CSS（カスタムスタイルシート）

### バックエンド
- **言語/フレームワーク**: Node.js, Express
- **認証**: JSON Web Token (JWT)
- **パスワード暗号化**: bcrypt

### データベース
- **RDBMS**: PostgreSQL
- **主要テーブル**:
  - ユーザー管理（users）
  - コース管理（courses）
  - 動画管理（videos）
  - 視聴ログ（view_logs）
  - 視聴統計（viewing_stats）

## 3. 簡易導入手順

### システム要件
- Node.js v14以上
- PostgreSQL v12以上
- npm または yarn

### 導入手順

#### データベースのセットアップ
```bash
# PostgreSQLにログイン
psql -U postgres

# データベースを作成
CREATE DATABASE videotracking;

# 作成したデータベースに接続
\c videotracking

# 初期化SQLを実行
\i path/to/init-db.sql
```

#### バックエンドのインストール
```bash
# リポジトリをクローン
git clone https://your-repo-url.git video-tracking
cd video-tracking/server

# 依存関係のインストール
npm install

# 環境変数の設定
cp .env.example .env
# .envファイルを適切に編集

# 開発モードで起動
npm run dev

# 本番モードで起動
npm start
```

#### フロントエンドのインストール
```bash
# フロントエンドディレクトリに移動
cd ../client

# 依存関係のインストール
npm install

# 環境変数の設定
cp .env.example .env
# .envファイルを適切に編集

# 開発モードで起動
npm start

# 本番用ビルドの作成
npm run build
```

## 4. 利用開始のステップ

1. **管理者アカウントの作成**
   ```sql
   INSERT INTO users (username, email, password_hash, is_admin)
   VALUES ('admin', 'admin@example.com', '$2b$10$...', true);
   ```
   ※ パスワードハッシュは `bcrypt` で生成したもの

2. **最初のコースの作成**
   - 管理者としてログイン
   - ダッシュボードから「新規コース作成」を選択
   - コース情報（タイトル、説明）を入力
   - 「コースを作成」ボタンをクリック

3. **動画の追加**
   - 作成したコースの詳細画面で「動画を追加」を選択
   - 動画情報を入力
   - 動画タイプを選択し、URLまたは埋め込みコードを入力
   - 「動画を追加」ボタンをクリック

4. **視聴者アカウントの作成と動画視聴**
   - 新規ユーザーとして登録
   - 利用可能なコース一覧から興味のあるコースを見つけて登録
   - コース内の動画を視聴
   - 視聴時間は自動的に記録される

5. **視聴統計の確認**
   - 管理者としてログイン
   - ダッシュボードから特定のコースを選択
   - 「統計」タブを選択して視聴データを確認

## 5. カスタマイズ可能なポイント

- **認証システム**:
  - ソーシャルログイン連携（Google, Facebook等）
  - シングルサインオン (SSO) の実装
  - 二要素認証の追加

- **動画機能**:
  - 新しい動画プロバイダーの追加
  - 字幕や複数言語のサポート
  - インタラクティブな要素（クイズ、アンケート）の挿入ポイント

- **分析機能**:
  - より詳細な分析ダッシュボード
  - データのエクスポート機能
  - ユーザー行動の予測分析

- **UIデザイン**:
  - テーマのカスタマイズ
  - レスポンシブデザインの最適化
  - アクセシビリティの向上

## 6. トラブルシューティング

- **接続エラー**:
  - データベース接続文字列が正しいことを確認
  - ファイアウォール設定を確認

- **認証問題**:
  - JWTシークレットが正しく設定されているか確認
  - トークンの有効期限を確認

- **動画再生の問題**:
  - プラットフォームのAPIが正しく動作しているか確認
  - CORS設定が適切か確認

- **パフォーマンスの問題**:
  - データベースにインデックスが適切に設定されているか確認
  - キャッシュ機構の実装を検討